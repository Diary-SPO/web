import{n as e,s as t,c as a,J as o,j as r,T as s,F as i,K as n,O as l,Q as c,U as _,V as d,W as m,X as u,Y as h,Z as p,S as f,$ as k,a0 as g,a1 as y,a2 as C,a3 as b,a4 as j,a as A,o as w,G as S,H as q,a5 as v,a6 as N,a7 as I,k as O}from"./index-12fcb1ba.js";import{P as R}from"./Panel-b4539d2d.js";import{y as B,j as z,h as P,b as M,T,o as V,p as x,a0 as K,a1 as L,a2 as F,a3 as H,a4 as W}from"./@vkontakte/icons-ec9bb119.js";import{I as Y}from"./IconButton-76d8afa6.js";import{B as $}from"./Button-a58ba127.js";import{C as G}from"./Caption-0505d051.js";import{P as J}from"./PanelHeaderWithBack-57ddcc92.js";import{u as U}from"./useSnackbar-10f2a8ee.js";import"./Snackbar-9cb98137.js";const D="_Alert_qrjrf_1",E="_Alert--desktop_qrjrf_16",Q="_Alert--closing_qrjrf_20",X="_Alert__content_qrjrf_38",Z="_Alert__content--withButton_qrjrf_43",ee="_Alert__action_qrjrf_47",te="_Alert__actions_qrjrf_52",ae="_Alert__header_qrjrf_59",oe="_Alert__text_qrjrf_63",re="_Alert--ios_qrjrf_106",se="_Alert__action--mode-cancel_qrjrf_241",ie="_Alert__action--mode-destructive_qrjrf_245",ne="_Alert--vkcom_qrjrf_253",le="_Alert__button_qrjrf_266",ce="_Alert__button--mode-cancel_qrjrf_270",_e="_Alert__dismiss_qrjrf_274",de=({mode:e,...t})=>B(o,{Component:t.href?"a":"button",className:a(ee,"destructive"===e&&ie,"cancel"===e&&se),...t}),me=({mode:o,...r})=>{let s="tertiary";return e()===t.VKCOM&&(s="cancel"===o?"secondary":"primary"),B($,{className:a(le,"cancel"===o&&ce),mode:s,size:"m",...r})},ue=a=>e()===t.IOS?B(de,a):B(me,a),he={left:"_Alert__actions--align-left_qrjrf_87",center:"_Alert__actions--align-center_qrjrf_92",right:"_Alert__actions--align-right_qrjrf_97"},pe={vertical:"_Alert__actions--direction-vertical_qrjrf_76",horizontal:"_Alert__actions--direction-horizontal_qrjrf_72"},fe=({actions:o=[],renderAction:r=(e=>B(ue,e)),onItemClick:s,actionsAlign:i,actionsLayout:n})=>{const l=e()===t.VKCOM?"horizontal":n;return B("div",{className:a(te,i&&he[i],l&&pe[l])},o.map(((e,t)=>{const{title:a,action:o,autoClose:i,...n}=e;return B(z,{key:t},r({children:a,onClick:()=>s(e),...n}))})))},ke=a=>e()===t.IOS?B(r,{className:ae,weight:"1",level:"3",...a}):B(r,{className:ae,weight:"2",level:"2",...a}),ge=a=>{switch(e()){case t.VKCOM:return B(i,{className:oe,...a});case t.IOS:return B(G,{className:oe,...a});default:return B(s,{Component:"span",className:oe,weight:"3",...a})}},ye=({actions:o=[],actionsLayout:r="horizontal",children:s,className:i,style:f,text:k,header:g,onClose:y,dismissLabel:C="Закрыть предупреждение",renderAction:b,actionsAlign:j,dismissButtonMode:A="outside",getRootRef:w,...S})=>{const q=n(),v=`vkui-alert-${q}-header`,N=`vkui-alert-${q}-text`,I=e(),{isDesktop:O}=l(),{waitTransitionFinish:R}=c(),[z,x]=P(!1),K=O&&I!==t.IOS,L=M(null),F=I===t.IOS?300:200,H=T((()=>{x(!0),R(L.current,(e=>{e&&"opacity"!==e.propertyName||y()}),F)}),[L,R,y,F]),W=T((e=>{const{action:t,autoClose:a}=e;a?(x(!0),R(L.current,(e=>{e&&"opacity"!==e.propertyName||(y(),t&&t())}),F)):t&&t()}),[L,R,y,F]);return _(),B(p,{className:i,closing:z,style:f,onClick:H,getRootRef:w},B(d,{...S,getRootRef:L,onClick:m,onClose:H,timeout:F,className:a(D,I===t.IOS&&re,I===t.VKCOM&&ne,z&&Q,O&&E),role:"alertdialog","aria-modal":!0,"aria-labelledby":v,"aria-describedby":N},B("div",{className:a(X,"inside"===A&&Z)},u(g)&&B(ke,{id:v},g),u(k)&&B(ge,{id:N},k),s,K&&"inside"===A&&B(Y,{"aria-label":C,className:a(_e,"vkuiInternalAlert__dismiss"),onClick:H,hoverMode:"opacity",activeMode:"opacity"},B(V,null))),B(fe,{actions:o,actionsAlign:j,actionsLayout:r,renderAction:b,onItemClick:W}),K&&"outside"===A&&B(h,{onClick:H,"aria-label":C})))},Ce="_CellButton_1uqh3_1",be="_CellButton--centered_1uqh3_29",je="_CellButton--mode-danger_1uqh3_51",Ae=({centered:e=!1,mode:t="primary",className:o,...r})=>B(f,{stopPropagation:!0,...r,className:a(Ce,"danger"===t&&je,e&&be,o)}),we="_Switch_prnkw_1",Se="_Switch--sizeY-compact_prnkw_16",qe="_Switch--disabled_prnkw_30",ve="_Switch__pseudo_prnkw_34",Ne="_Switch__self_prnkw_85",Ie="_Switch--ios_prnkw_146",Oe={none:"_Switch--sizeY-none_prnkw_23",[k.COMPACT]:Se},Re=({style:o,className:r,getRootRef:s,getRef:i,...n})=>{const l=e(),{sizeY:c="none"}=g(),{focusVisible:_,onBlur:d,onFocus:m}=y();return B("label",{className:a(we,l===t.IOS&&Ie,c!==k.REGULAR&&Oe[c],n.disabled&&qe,r),style:o,ref:s,onBlur:b(d,n.onBlur),onFocus:b(m,n.onFocus)},B(C,{...n,Component:"input",getRootRef:i,type:"checkbox",className:Ne}),B("span",{"aria-hidden":!0,className:ve}),B(j,{visible:_,mode:"outside"}))},Be=({id:e})=>{const t=A(),[a,o]=U(),[r,s]=P([]),[i,n]=P(!1),l=M(null),[c,_]=P(!0),[d,m]=P(!1);x((()=>{(async()=>{await O.send("VKWebAppAddToHomeScreenInfo").then((({is_feature_supported:e})=>{e&&n(!0)})).catch((e=>{}))})()}),[]),x((()=>{const e=Object.keys(localStorage).map((e=>({key:e,value:localStorage.getItem(e)||"false"})));s(e)}),[]);const u=()=>{o({title:"Выход",icon:w(F,{color:"var(--vkui--color_background_accent_themed)"}),subtitle:"После удаления всех данных вы попадёте на страницу авторизации"}),setTimeout((async()=>{try{await(async()=>{localStorage.clear(),window.location.reload()})(),await t.replace("/")}catch(e){}}),1500)},h=w(ye,{actions:[{title:"Отмена",autoClose:!0,mode:"cancel"},{title:"Выйти",autoClose:!0,mode:"destructive",action:()=>u()}],actionsLayout:"horizontal",onClose:()=>t.hidePopout(),header:"Выход",text:"Вы уверены, что хотите выйти из аккаунта?"});return w(R,{nav:e,children:[w(J,{title:"Настройки"}),w(S,{header:w(q,{mode:"secondary",children:"Действия"}),children:[d&&w(v,{size:"medium"}),w(Ae,{Component:"label",after:w(Re,{getRef:l,defaultChecked:!0}),onChange:()=>_(!c),before:w(K,{}),children:"Показывать тех. инфрмацию"}),w(Ae,{before:w(L,{}),onClick:async()=>{const e=localStorage.getItem("log"),t=localStorage.getItem("main");if(e&&t)try{m(!0);const a=await fetch("https://api.spo-diary.ru/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:e,password:t,isRemember:!0})}),r=await a.json();if(!r.cookie)return void o({title:"Сервер вернул что-то плохое",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"});localStorage.setItem("cookie",r.cookie),o({title:"Cookie обновлена",icon:w(W,{}),subtitle:"Не забывайте периодически это делать"})}catch(e){o({title:"Ошибка на сервере",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"})}finally{m(!1)}else o({title:"Чего-то не хватает",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"})},children:"Обновить cookie"}),w(Ae,{before:w(F,{}),onClick:()=>t.showPopout(h),children:"Выйти"}),i&&w(Ae,{before:w(H,{}),onClick:()=>{O.send("VKWebAppAddToHomeScreen").then((e=>{e.result})).catch((e=>{}))},children:"Добавить на экран"})]}),c&&w(S,{header:w(q,{mode:"secondary",children:"Техническая информация"}),children:w(S,{header:w(q,{mode:"secondary",aside:w(N,{children:"Хранится в LocalStorage"}),children:"Кеш"}),children:r.map((e=>w(f,{children:w(I,{header:e.key,children:e.value.slice(0,30)})},e.key)))})}),a]})};export{Be as default};
