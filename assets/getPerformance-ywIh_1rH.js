var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(r,t,s)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,l=(e,r)=>{for(var t in r||(r={}))a.call(r,t)&&n(e,t,r[t]);if(s)for(var t of s(r))o.call(r,t)&&n(e,t,r[t]);return e},i=(e,r)=>{var t={};for(var n in e)a.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&s)for(var n of s(e))r.indexOf(n)<0&&o.call(e,n)&&(t[n]=e[n]);return t};import{y as c,f as p,h as f,e as u,T as h}from"./@vkontakte/icons-HJ4wZ9QE.js";import{l as m,c as _,R as v,m as d,n as g,o as b,p as O,q as P,r as y,s as x,t as I,v as S,w as R,x as T,y as k,z as w}from"./index-SX1lXMFJ.js";import{m as j}from"./makeRequest-NP7h63fm.js";const N="_PullToRefresh_1lr1i_1",W="_PullToRefresh--refreshing_1lr1i_5",M="_PullToRefresh__controls_1lr1i_10",$="_PullToRefresh--ios_1lr1i_15",D="_PullToRefresh__spinner_1lr1i_19",E="_PullToRefresh--watching_1lr1i_42",Y="_PullToRefresh__spinner-self_1lr1i_46",z="_PullToRefresh__spinner-path_1lr1i_54",L="_PullToRefresh__spinner--on_1lr1i_65",q="_PullToRefresh__content_1lr1i_69";const A=e=>{var r=e,{on:t=!0,size:s=24,strokeWidth:a=2.5,progress:o=0,"aria-label":n="Пожалуйста, подождите..."}=r,p=i(r,["on","size","strokeWidth","progress","aria-label"]);const f=.5*s-.5*a,u=2*Math.PI*f,h=.5*s,m=function(e,r){const t=e/100;return 2*Math.PI*r*(1-t)}(t?80:o,f);return c(v,l({baseClassName:_(D,t&&L),"aria-label":t?n:void 0},p),c("svg",{role:"presentation",className:Y,style:{width:s,height:s},viewBox:`0 0 ${s} ${s}`,xmlns:"http://www.w3.org/2000/svg"},c("g",{style:{width:s,height:s,transformOrigin:`${h}px ${h}px`}},c("circle",{className:z,fill:"none",strokeDasharray:u,strokeDashoffset:m,strokeWidth:a,strokeLinecap:"round",cx:h,cy:h,r:f}))))};function F(e){if(!e)return!1;for(;e.originalEvent;)e=e.originalEvent;return e.preventDefault&&e.cancelable&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}const K={cancelable:!0,passive:!1},V=e=>{var s=e,{children:a,isFetching:o,onRefresh:n,className:v}=s,j=i(s,["children","isFetching","onRefresh","className"]);const D=d(),Y=g(),{document:z}=b(),L=O(o),V=p((()=>({start:D===P.IOS?-10:-45,max:D===P.IOS?50:80,maxY:D===P.IOS?400:80,refreshing:D===P.IOS?36:50,positionMultiplier:D===P.IOS?.21:1})),[D]),[B,C]=f(V.start),[G,H]=f(!1),[J,Q]=f(!1),[U,X]=f(!1),[Z,ee]=f(!1),re=O(Z),te=u(0),[se,ae]=f(0),[oe,ne]=f(0),le=h((()=>{H(!1),X(!1),Q(!1),C(V.start),ne(0),ae(0)}),[V]),ie=h((()=>{Z||le()}),[Z,le]),{set:ce,clear:pe}=y(ie,1e3);x((()=>{void 0!==L&&L&&!o&&ie()}),[L,o,ie]),x((()=>{void 0!==L&&!L&&o&&pe()}),[o,L,pe]);const fe=h((()=>{if(!J&&n){ce(),Q(!0),C((e=>D===P.IOS?e:V.refreshing));n()||(e="light",m.supports("VKWebAppTapticImpactOccurred")&&m.send("VKWebAppTapticImpactOccurred",{style:e}).catch((()=>{})))}var e}),[J,n,ce,D,V.refreshing]);x((()=>{void 0!==re&&re&&!Z&&(!J&&U?fe():J&&!o?le():(C(J?V.refreshing:V.start),ne(0),ae(0)))}),[V,L,o,ie,re,Z,J,U,fe]);const ue=u(0);I(z,"touchmove",(e=>{(e=>{if(G||J)return!0;const r=w(e)-ue.current;return 0===(null==Y?void 0:Y.getScroll().y)&&r>0&&Z})(e)&&(e.preventDefault(),e.stopPropagation())}),K);const he=`translate3d(0, ${B}px, 0)`;let me="";return D===P.IOS&&J&&!Z?me="translate3d(0, 100px, 0)":D===P.IOS&&(se||J)&&(me=`translate3d(0, ${se}px, 0)`),c(T.Provider,{value:!0},c(S,(_e=l({},j),ve={onStart:e=>{J&&F(e),ee(!0),ue.current=e.startY,z&&z.documentElement.classList.add("vkui--disable-overscroll-behavior")},onMove:e=>{const{isY:r,shiftY:t}=e,{start:s,max:a}=V,o=null==Y?void 0:Y.getScroll().y;if(G&&Z){F(e);const{positionMultiplier:r,maxY:o}=V,n=Math.max(0,t-te.current),l=k(s+n*r,s,o),i=l>-10?80*Math.abs((l+10)/a):0;C(l),ne(k(i,0,80)),X(i>80),ae(2.3*(l+10)),i>85&&!J&&D===P.IOS&&fe()}else r&&0===o&&t>0&&!J&&Z&&(F(e),te.current=t,H(!0),C(s),ne(0))},onEnd:()=>{H(!1),ee(!1),z&&z.documentElement.classList.remove("vkui--disable-overscroll-behavior")},className:_(N,D===P.IOS&&$,G&&E,J&&W,v)},r(_e,t(ve))),c(R,{className:M,useParentWidth:!0},c(A,{style:{transform:he,WebkitTransform:he,opacity:G||J||U?1:0},on:J,progress:J?void 0:oe})),c("div",{className:q,style:{transform:me,WebkitTransform:me}},a)));var _e,ve},B=async()=>{const e=localStorage.getItem("id");return e?j(`/performance.current/${e}`):418};export{V as P,B as g};
