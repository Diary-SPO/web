import{h as e,T as t,b as n,F as r,y as o}from"./@vkontakte/icons-ec9bb119.js";import{v as a,k as s,q as l,aD as i,aE as u,w as d,$ as c,aF as p,a0 as m,aG as b,aa as f,aH as y,aI as v,aB as k,c as _}from"./index-12fcb1ba.js";let h={bottom:null,top:null,left:null,right:null};const P="_AppRoot_anbkk_1",E="_AppRoot--pointer-has-not_anbkk_5",A="_AppRoot--pointer-none_anbkk_25",R={none:"vkui--sizeX-none",[c.REGULAR]:"vkui--sizeX-regular"},L={card:"vkui--layout-card",plain:"vkui--layout-plain"};const w="--vkui_internal--safe_area_inset_",I=({children:I,mode:g="full",scroll:x="global",portalRoot:C=null,disablePortal:K,disableParentTransformForPositionFixedElements:z,className:F,safeAreaInsets:O,layout:T,...U})=>{const X=function(){const{document:n}=l(),[r,o]=e(!1),a=t((()=>{o(!0)}),[]),s=t((e=>{i(e)===u.TAB&&a()}),[a]),c=t((()=>{o(!1)}),[]),p={passive:!0,capture:!0};return d(n,"keydown",s,p),d(n,"mousedown",c,p),d(n,"touchstart",c,p),d(n,"enableKeyboardInput",a,p),d(n,"disableKeyboardInput",c,p),r}(),$=n(null),[j,B]=e(null),{document:G}=l(),N=function(t=!1){const[n,r]=e(h);return a((()=>{if(t)return;const e=e=>{const t=function(e){const{type:t,data:n}=e.detail;switch(t){case"VKWebAppUpdateConfig":case"VKWebAppUpdateInsets":const{insets:e}=n;if(e)return{...e,bottom:e.bottom>150?0:e.bottom}}return null}(e);t&&r(t)};return s.subscribe(e),()=>{s.unsubscribe(e)}}),[t]),n}(!O),V=O||N,W=p(),{hasPointer:q,sizeX:D="none"}=m();a((()=>{let e=null;return C&&(e=b(C)?C.current:C),e||(e=G.createElement("div"),G.body.appendChild(e)),B(e),()=>{C||e?.parentElement?.removeChild(e)}}),[C]),a((()=>{if("partial"===g)return f;const e=$.current?.parentElement,t=["vkui__root"].concat("embedded"===g?"vkui__root--embedded":[]);return e&&("embedded"!==g||z||(e.style.transform="translate3d(0, 0, 0)"),e.classList.add(...t)),()=>{e&&("embedded"!==g||z||(e.style.transform=""),e.classList.remove(...t))}}),[z]),a((()=>{if("full"===g)return G.documentElement.classList.add("vkui"),()=>{G.documentElement.classList.remove("vkui")}}),[G,g]),a((()=>{if("partial"===g||!$.current?.parentElement)return f;const e=$.current.parentElement;let t;for(t in V)if(V.hasOwnProperty(t)&&"number"==typeof V[t]){const n=V[t];e.style.setProperty(w+t,`${n}px`),j&&j.style.setProperty(w+t,`${n}px`)}return()=>{let t;for(t in V)V.hasOwnProperty(t)&&(e.style.removeProperty(w+t),j&&j.style.removeProperty(w+t))}}),[V,j]),a((()=>{if("partial"===g)return f;const e=function(e,t){const n=[];return e&&n.push(L[e]),t!==c.COMPACT&&n.push(R[t]),n}(T,D),t="embedded"===g?$.current?.parentElement:G.body;return e.length&&t?(t.classList.add(...e),()=>{t.classList.remove(...e)}):f}),[D,T]),a((()=>"full"!==g||void 0===W?f:(G.documentElement.style.setProperty("color-scheme",W),()=>G.documentElement.style.removeProperty("color-scheme"))),[W]);const H=r((()=>"contain"===x?y:v),[x]),M=o(k.Provider,{value:{appRoot:$,portalRoot:j,embedded:"embedded"===g,keyboardInput:X,mode:g,disablePortal:K,layout:T}},o(H,{elRef:$},I));return"partial"===g?M:o("div",{ref:$,className:_(P,void 0===q?A:!q&&E,F),...U},M)};export{I as A};
