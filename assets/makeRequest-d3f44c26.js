var t;import{y as e,Q as a}from"./@vkontakte/icons-d137ec12.js";const o=(t,o,r,s,n)=>{if(418===t){const t=e(a,{fill:"var(--vkui--color_icon_negative)"});return n&&n({icon:t,title:"Ошибка при попытке сделать запрос",subtitle:"Попробуйте обновить страницу или обновите куки в настройках"}),s(!1),void o()}429===t&&(r(),o(),s(!1))},r="https://api.spo-diary.ru",s=null!=(t={}.VITE_SERVER_URL_SECOND)?t:"",n=async t=>{var e;const a=null!=(e=localStorage.getItem("cookie"))?e:sessionStorage.getItem("cookie"),o=`${r}${t}`;if(!a)return 418;try{const e=await fetch(r+t,{method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8",secret:a}});if(429===e.status)return e.status;if(!e.ok){const e=await fetch(s+t,{method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8",secret:a}});if(429===e.status)return e.status;if(!e.ok)throw new Error(`Failed to fetch data from ${o} and SECOND_SERVER`);return await e.json()}return await e.json()}catch(e){const r=await fetch(s+t,{method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8",secret:a}});if(429===r.status)return r.status;if(!r.ok)throw new Error(`Failed to fetch data from ${o} and SECOND_SERVER`);return await r.json()}};export{o as h,n as m};
