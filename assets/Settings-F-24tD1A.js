var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&n(e,a,t[a]);if(o)for(var a of o(t))s.call(t,a)&&n(e,a,t[a]);return e},l=(e,o)=>t(e,a(o)),c=(e,t)=>{var a={};for(var n in e)r.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&o)for(var n of o(e))t.indexOf(n)<0&&s.call(e,n)&&(a[n]=e[n]);return a};import{m as _,q as d,c as m,B as u,i as f,T as p,F as h,D as y,I as b,J as g,K as k,N as j,O as C,Q as v,U as A,V as w,S,W as O,X as q,Y as N,Z as R,$ as I,a0 as B,b as P,u as x,G as z,H as L,a1 as M,a2 as T,a3 as V,j as K}from"./index-5NH1IOHB.js";import{P as F}from"./Panel-lWp-K2Ib.js";import{y as H,l as W,h as Y,b as D,T as $,o as E,p as G,a0 as J,a1 as U,a2 as Q,a3 as X,a4 as Z}from"./@vkontakte/icons-Hmxnb1rK.js";import{I as ee}from"./IconButton-8vLYScVl.js";import{B as te}from"./Button-5EGKVaCy.js";import{C as ae}from"./Caption-uXIV38VC.js";import{P as oe}from"./PanelHeaderWithBack-ikCXfPmR.js";import{u as re}from"./useSnackbar-OsAXi3gS.js";import"./Snackbar-juR0A3an.js";const se="_Alert_qrjrf_1",ne="_Alert--desktop_qrjrf_16",ie="_Alert--closing_qrjrf_20",le="_Alert__content_qrjrf_38",ce="_Alert__content--withButton_qrjrf_43",_e="_Alert__action_qrjrf_47",de="_Alert__actions_qrjrf_52",me="_Alert__header_qrjrf_59",ue="_Alert__text_qrjrf_63",fe="_Alert--ios_qrjrf_106",pe="_Alert__action--mode-cancel_qrjrf_241",he="_Alert__action--mode-destructive_qrjrf_245",ye="_Alert--vkcom_qrjrf_253",be="_Alert__button_qrjrf_266",ge="_Alert__button--mode-cancel_qrjrf_270",ke="_Alert__dismiss_qrjrf_274",je=e=>{var t=e,{mode:a}=t,o=c(t,["mode"]);return H(u,i({Component:o.href?"a":"button",className:m(_e,"destructive"===a&&he,"cancel"===a&&pe)},o))},Ce=e=>{var t=e,{mode:a}=t,o=c(t,["mode"]);let r="tertiary";return _()===d.VKCOM&&(r="cancel"===a?"secondary":"primary"),H(te,i({className:m(be,"cancel"===a&&ge),mode:r,size:"m"},o))},ve=e=>_()===d.IOS?H(je,e):H(Ce,e),Ae={left:"_Alert__actions--align-left_qrjrf_87",center:"_Alert__actions--align-center_qrjrf_92",right:"_Alert__actions--align-right_qrjrf_97"},we={vertical:"_Alert__actions--direction-vertical_qrjrf_76",horizontal:"_Alert__actions--direction-horizontal_qrjrf_72"},Se=({actions:e=[],renderAction:t=(e=>H(ve,e)),onItemClick:a,actionsAlign:o,actionsLayout:r})=>{const s=_()===d.VKCOM?"horizontal":r;return H("div",{className:m(de,o&&Ae[o],s&&we[s])},e.map(((e,o)=>{const r=e,{title:s,action:n,autoClose:l}=r,_=c(r,["title","action","autoClose"]);return H(W,{key:o},t(i({children:s,onClick:()=>a(e)},_)))})))},Oe=e=>_()===d.IOS?H(f,i({className:me,weight:"1",level:"3"},e)):H(f,i({className:me,weight:"2",level:"2"},e)),qe=e=>{switch(_()){case d.VKCOM:return H(h,i({className:ue},e));case d.IOS:return H(ae,i({className:ue},e));default:return H(p,i({Component:"span",className:ue,weight:"3"},e))}},Ne=e=>{var t=e,{actions:a=[],actionsLayout:o="horizontal",children:r,className:s,style:n,text:u,header:f,onClose:p,dismissLabel:h="Закрыть предупреждение",renderAction:S,actionsAlign:O,dismissButtonMode:q="outside",getRootRef:N}=t,R=c(t,["actions","actionsLayout","children","className","style","text","header","onClose","dismissLabel","renderAction","actionsAlign","dismissButtonMode","getRootRef"]);const I=y(),B=`vkui-alert-${I}-header`,P=`vkui-alert-${I}-text`,x=_(),{isDesktop:z}=b(),{waitTransitionFinish:L}=g(),[M,T]=Y(!1),V=z&&x!==d.IOS,K=D(null),F=x===d.IOS?300:200,W=$((()=>{T(!0),L(K.current,(e=>{e&&"opacity"!==e.propertyName||p()}),F)}),[K,L,p,F]),G=$((e=>{const{action:t,autoClose:a}=e;a?(T(!0),L(K.current,(e=>{e&&"opacity"!==e.propertyName||(p(),t&&t())}),F)):t&&t()}),[K,L,p,F]);return k(),H(w,{className:s,closing:M,style:n,onClick:W,getRootRef:N},H(j,l(i({},R),{getRootRef:K,onClick:C,onClose:W,timeout:F,className:m(se,x===d.IOS&&fe,x===d.VKCOM&&ye,M&&ie,z&&ne),role:"alertdialog","aria-modal":!0,"aria-labelledby":B,"aria-describedby":P}),H("div",{className:m(le,"inside"===q&&ce)},v(f)&&H(Oe,{id:B},f),v(u)&&H(qe,{id:P},u),r,V&&"inside"===q&&H(ee,{"aria-label":h,className:m(ke,"vkuiInternalAlert__dismiss"),onClick:W,hoverMode:"opacity",activeMode:"opacity"},H(E,null))),H(Se,{actions:a,actionsAlign:O,actionsLayout:o,renderAction:S,onItemClick:G}),V&&"outside"===q&&H(A,{onClick:W,"aria-label":h})))},Re="_CellButton_1uqh3_1",Ie="_CellButton--centered_1uqh3_29",Be="_CellButton--mode-danger_1uqh3_51",Pe=e=>{var t=e,{centered:a=!1,mode:o="primary",className:r}=t,s=c(t,["centered","mode","className"]);return H(S,l(i({stopPropagation:!0},s),{className:m(Re,"danger"===o&&Be,a&&Ie,r)}))},xe="_Switch_prnkw_1",ze="_Switch--sizeY-compact_prnkw_16",Le="_Switch--disabled_prnkw_30",Me="_Switch__pseudo_prnkw_34",Te="_Switch__self_prnkw_85",Ve="_Switch--ios_prnkw_146",Ke={none:"_Switch--sizeY-none_prnkw_23",[O.COMPACT]:ze},Fe=e=>{var t=e,{style:a,className:o,getRootRef:r,getRef:s}=t,n=c(t,["style","className","getRootRef","getRef"]);const u=_(),{sizeY:f="none"}=q(),{focusVisible:p,onBlur:h,onFocus:y}=N();return H("label",{className:m(xe,u===d.IOS&&Ve,f!==O.REGULAR&&Ke[f],n.disabled&&Le,o),style:a,ref:r,onBlur:I(h,n.onBlur),onFocus:I(y,n.onFocus)},H(R,l(i({},n),{Component:"input",getRootRef:s,type:"checkbox",className:Te})),H("span",{"aria-hidden":!0,className:Me}),H(B,{visible:p,mode:"outside"}))},He=({id:e})=>{const t=P(),[a,o]=re(),[r,s]=Y([]),[n,i]=Y(!1),l=D(null),[c,_]=Y(!0),[d,m]=Y(!1);G((()=>{(async()=>{await K.send("VKWebAppAddToHomeScreenInfo").then((({is_feature_supported:e})=>{e&&i(!0)})).catch((e=>{}))})()}),[]),G((()=>{const e=Object.keys(localStorage).map((e=>({key:e,value:localStorage.getItem(e)||"false"})));s(e)}),[]);const u=()=>{o({title:"Выход",icon:x(Q,{color:"var(--vkui--color_background_accent_themed)"}),subtitle:"После удаления всех данных вы попадёте на страницу авторизации"}),setTimeout((async()=>{try{await(async()=>{localStorage.clear(),window.location.reload()})(),await t.replace("/")}catch(e){}}),1500)},f=x(Ne,{actions:[{title:"Отмена",autoClose:!0,mode:"cancel"},{title:"Выйти",autoClose:!0,mode:"destructive",action:()=>u()}],actionsLayout:"horizontal",onClose:()=>t.hidePopout(),header:"Выход",text:"Вы уверены, что хотите выйти из аккаунта?"});return x(F,{nav:e,children:[x(oe,{title:"Настройки"}),x(z,{header:x(L,{mode:"secondary",children:"Действия"}),children:[d&&x(M,{size:"medium"}),x(Pe,{Component:"label",after:x(Fe,{getRef:l,defaultChecked:!0}),onChange:()=>_(!c),before:x(J,{}),children:"Показывать тех. инфрмацию"}),x(Pe,{before:x(U,{}),onClick:async()=>{const e=localStorage.getItem("log"),t=localStorage.getItem("main");if(e&&t)try{m(!0);const a=await fetch("https://dnevnik3.kopchan7.keenetic.link/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:e,password:t,isRemember:!0})}),r=await a.json();if(!r.cookie)return void o({title:"Сервер вернул что-то плохое",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"});localStorage.setItem("cookie",r.cookie),o({title:"Cookie обновлена",icon:x(Z,{}),subtitle:"Не забывайте периодически это делать"})}catch(e){o({title:"Ошибка на сервере",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"})}finally{m(!1)}else o({title:"Чего-то не хватает",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"})},children:"Обновить cookie"}),x(Pe,{before:x(Q,{}),onClick:()=>t.showPopout(f),children:"Выйти"}),n&&x(Pe,{before:x(X,{}),onClick:()=>{K.send("VKWebAppAddToHomeScreen").then((e=>{e.result})).catch((e=>{}))},children:"Добавить на экран"})]}),c&&x(z,{header:x(L,{mode:"secondary",children:"Техническая информация"}),children:x(z,{header:x(L,{mode:"secondary",aside:x(T,{children:"Хранится в LocalStorage"}),children:"Кеш"}),children:r.map((e=>x(S,{children:x(V,{header:e.key,children:e.value.slice(0,30)})},e.key)))})}),a]})};export{He as default};
