var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,n=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&i(e,a,t[a]);if(o)for(var a of o(t))s.call(t,a)&&i(e,a,t[a]);return e},l=(e,o)=>t(e,a(o)),c=(e,t)=>{var a={};for(var i in e)r.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&o)for(var i of o(e))t.indexOf(i)<0&&s.call(e,i)&&(a[i]=e[i]);return a};import{l as _,q as d,c as m,B as u,h as f,T as p,F as h,I as y,J as g,K as b,O as k,Q as j,U as C,V as A,W as v,X as w,S,Y as O,Z as q,$ as N,a0 as R,a1 as I,a2 as B,a as P,o as x,G as z,H as L,a3 as M,a4 as T,a5 as V,i as K}from"./index-716dd2fc.js";import{P as F}from"./Panel-eb4ddde2.js";import{y as H,g as W,h as Y,b as $,T as D,l as E,p as G,Z as J,$ as U,a0 as Z,a1 as Q,a2 as X}from"./@vkontakte/icons-d137ec12.js";import{I as ee}from"./IconButton-634e1b68.js";import{B as te}from"./Button-9144f7df.js";import{C as ae}from"./Caption-ba308cb2.js";import{P as oe}from"./PanelHeaderWithBack-cc3484e7.js";import{u as re}from"./useSnackbar-8d09d7d9.js";import"./Snackbar-3177c796.js";const se="_Alert_qrjrf_1",ie="_Alert--desktop_qrjrf_16",ne="_Alert--closing_qrjrf_20",le="_Alert__content_qrjrf_38",ce="_Alert__content--withButton_qrjrf_43",_e="_Alert__action_qrjrf_47",de="_Alert__actions_qrjrf_52",me="_Alert__header_qrjrf_59",ue="_Alert__text_qrjrf_63",fe="_Alert--ios_qrjrf_106",pe="_Alert__action--mode-cancel_qrjrf_241",he="_Alert__action--mode-destructive_qrjrf_245",ye="_Alert--vkcom_qrjrf_253",ge="_Alert__button_qrjrf_266",be="_Alert__button--mode-cancel_qrjrf_270",ke="_Alert__dismiss_qrjrf_274",je=e=>{var t=e,{mode:a}=t,o=c(t,["mode"]);return H(u,n({Component:o.href?"a":"button",className:m(_e,"destructive"===a&&he,"cancel"===a&&pe)},o))},Ce=e=>{var t=e,{mode:a}=t,o=c(t,["mode"]);let r="tertiary";return _()===d.VKCOM&&(r="cancel"===a?"secondary":"primary"),H(te,n({className:m(ge,"cancel"===a&&be),mode:r,size:"m"},o))},Ae=e=>_()===d.IOS?H(je,e):H(Ce,e),ve={left:"_Alert__actions--align-left_qrjrf_87",center:"_Alert__actions--align-center_qrjrf_92",right:"_Alert__actions--align-right_qrjrf_97"},we={vertical:"_Alert__actions--direction-vertical_qrjrf_76",horizontal:"_Alert__actions--direction-horizontal_qrjrf_72"},Se=({actions:e=[],renderAction:t=(e=>H(Ae,e)),onItemClick:a,actionsAlign:o,actionsLayout:r})=>{const s=_()===d.VKCOM?"horizontal":r;return H("div",{className:m(de,o&&ve[o],s&&we[s])},e.map(((e,o)=>{const r=e,{title:s,action:i,autoClose:l}=r,_=c(r,["title","action","autoClose"]);return H(W,{key:o},t(n({children:s,onClick:()=>a(e)},_)))})))},Oe=e=>_()===d.IOS?H(f,n({className:me,weight:"1",level:"3"},e)):H(f,n({className:me,weight:"2",level:"2"},e)),qe=e=>{switch(_()){case d.VKCOM:return H(h,n({className:ue},e));case d.IOS:return H(ae,n({className:ue},e));default:return H(p,n({Component:"span",className:ue,weight:"3"},e))}},Ne=e=>{var t=e,{actions:a=[],actionsLayout:o="horizontal",children:r,className:s,style:i,text:u,header:f,onClose:p,dismissLabel:h="Закрыть предупреждение",renderAction:S,actionsAlign:O,dismissButtonMode:q="outside",getRootRef:N}=t,R=c(t,["actions","actionsLayout","children","className","style","text","header","onClose","dismissLabel","renderAction","actionsAlign","dismissButtonMode","getRootRef"]);const I=y(),B=`vkui-alert-${I}-header`,P=`vkui-alert-${I}-text`,x=_(),{isDesktop:z}=g(),{waitTransitionFinish:L}=b(),[M,T]=Y(!1),V=z&&x!==d.IOS,K=$(null),F=x===d.IOS?300:200,W=D((()=>{T(!0),L(K.current,(e=>{e&&"opacity"!==e.propertyName||p()}),F)}),[K,L,p,F]),G=D((e=>{const{action:t,autoClose:a}=e;a?(T(!0),L(K.current,(e=>{e&&"opacity"!==e.propertyName||(p(),t&&t())}),F)):t&&t()}),[K,L,p,F]);return k(),H(w,{className:s,closing:M,style:i,onClick:W,getRootRef:N},H(j,l(n({},R),{getRootRef:K,onClick:C,onClose:W,timeout:F,className:m(se,x===d.IOS&&fe,x===d.VKCOM&&ye,M&&ne,z&&ie),role:"alertdialog","aria-modal":!0,"aria-labelledby":B,"aria-describedby":P}),H("div",{className:m(le,"inside"===q&&ce)},A(f)&&H(Oe,{id:B},f),A(u)&&H(qe,{id:P},u),r,V&&"inside"===q&&H(ee,{"aria-label":h,className:m(ke,"vkuiInternalAlert__dismiss"),onClick:W,hoverMode:"opacity",activeMode:"opacity"},H(E,null))),H(Se,{actions:a,actionsAlign:O,actionsLayout:o,renderAction:S,onItemClick:G}),V&&"outside"===q&&H(v,{onClick:W,"aria-label":h})))},Re="_CellButton_1uqh3_1",Ie="_CellButton--centered_1uqh3_29",Be="_CellButton--mode-danger_1uqh3_51",Pe=e=>{var t=e,{centered:a=!1,mode:o="primary",className:r}=t,s=c(t,["centered","mode","className"]);return H(S,l(n({stopPropagation:!0},s),{className:m(Re,"danger"===o&&Be,a&&Ie,r)}))},xe="_Switch_prnkw_1",ze="_Switch--sizeY-compact_prnkw_16",Le="_Switch--disabled_prnkw_30",Me="_Switch__pseudo_prnkw_34",Te="_Switch__self_prnkw_85",Ve="_Switch--ios_prnkw_146",Ke={none:"_Switch--sizeY-none_prnkw_23",[O.COMPACT]:ze},Fe=e=>{var t=e,{style:a,className:o,getRootRef:r,getRef:s}=t,i=c(t,["style","className","getRootRef","getRef"]);const u=_(),{sizeY:f="none"}=q(),{focusVisible:p,onBlur:h,onFocus:y}=N();return H("label",{className:m(xe,u===d.IOS&&Ve,f!==O.REGULAR&&Ke[f],i.disabled&&Le,o),style:a,ref:r,onBlur:I(h,i.onBlur),onFocus:I(y,i.onFocus)},H(R,l(n({},i),{Component:"input",getRootRef:s,type:"checkbox",className:Te})),H("span",{"aria-hidden":!0,className:Me}),H(B,{visible:p,mode:"outside"}))},He=({id:e})=>{const t=P(),[a,o]=re(),[r,s]=Y([]),[i,n]=Y(!1),l=$(null),[c,_]=Y(!0),[d,m]=Y(!1);G((()=>{(async()=>{await K.send("VKWebAppAddToHomeScreenInfo").then((({is_feature_supported:e})=>{e&&n(!0)})).catch((e=>{}))})()}),[]),G((()=>{const e=Object.keys(localStorage).map((e=>({key:e,value:localStorage.getItem(e)||"false"})));s(e)}),[]);const u=()=>{o({title:"Выход",icon:x(Z,{color:"var(--vkui--color_background_accent_themed)"}),subtitle:"После удаления всех данных вы попадёте на страницу авторизации"}),setTimeout((async()=>{try{await(async()=>{localStorage.clear(),window.location.reload()})(),await t.replace("/")}catch(e){}}),1500)},f=x(Ne,{actions:[{title:"Отмена",autoClose:!0,mode:"cancel"},{title:"Выйти",autoClose:!0,mode:"destructive",action:()=>u()}],actionsLayout:"horizontal",onClose:()=>t.hidePopout(),header:"Выход",text:"Вы уверены, что хотите выйти из аккаунта?"});return x(F,{nav:e,children:[x(oe,{title:"Настройки"}),x(z,{header:x(L,{mode:"secondary",children:"Действия"}),children:[d&&x(M,{size:"medium"}),x(Pe,{Component:"label",after:x(Fe,{getRef:l,defaultChecked:!0}),onChange:()=>_(!c),before:x(J,{}),children:"Показывать тех. инфрмацию"}),x(Pe,{before:x(U,{}),onClick:async()=>{const e=localStorage.getItem("log"),t=localStorage.getItem("main");if(e&&t)try{m(!0);const a=await fetch("https://api.spo-diary.ru/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:e,password:t,isRemember:!0})}),r=await a.json();if(!r.cookie)return void o({title:"Сервер вернул что-то плохое",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"});localStorage.setItem("cookie",r.cookie),o({title:"Cookie обновлена",icon:x(X,{}),subtitle:"Не забывайте периодически это делать"})}catch(e){o({title:"Ошибка на сервере",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"})}finally{m(!1)}else o({title:"Чего-то не хватает",subtitle:"Попробуйте перезайти в аккаунт или сообщите об ошибке"})},children:"Обновить cookie"}),x(Pe,{before:x(Z,{}),onClick:()=>t.showPopout(f),children:"Выйти"}),i&&x(Pe,{before:x(Q,{}),onClick:()=>{K.send("VKWebAppAddToHomeScreen").then((e=>{e.result})).catch((e=>{}))},children:"Добавить на экран"})]}),c&&x(z,{header:x(L,{mode:"secondary",children:"Техническая информация"}),children:x(z,{header:x(L,{mode:"secondary",aside:x(T,{children:"Хранится в LocalStorage"}),children:"Кеш"}),children:r.map((e=>x(S,{children:x(V,{header:e.key,children:e.value.slice(0,30)})},e.key)))})}),a]})};export{He as default};
